(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{345:function(t,r,a){"use strict";a.r(r);var l=a(14),e=Object(l.a)({},(function(){var t=this,r=t._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"webpack"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[t._v("#")]),t._v(" Webpack")]),t._v(" "),r("p",[t._v("20220220 海淀图书馆（北区）F3 东侧靠窗 二刷")]),t._v(" "),r("h2",{attrs:{id:"核心理念"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#核心理念"}},[t._v("#")]),t._v(" 核心理念")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("编译打包")])])])]),t._v(" "),r("h2",{attrs:{id:"核心手段"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#核心手段"}},[t._v("#")]),t._v(" 核心手段")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("loader(转换)、plugin(除转换外更强悍的能力)、入口entry(依赖的开始)、输出output")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("Webpack5中会启用多进程构建，速度会更快；不再支持Node模块，专注Web。(2020-10-10已发布) "),r("a",{attrs:{href:"https://webpack.docschina.org/blog/2020-10-10-webpack-5-release",target:"_blank",rel:"noopener noreferrer"}},[t._v("官链"),r("OutboundLink")],1)])])])]),t._v(" "),r("h2",{attrs:{id:"loader"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#loader"}},[t._v("#")]),t._v(" loader")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("本质上是一个function，入口参数source")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("实践：TODO")])])]),t._v(" "),r("li",[t._v("参链："),r("a",{attrs:{href:"https://juejin.cn/post/6992738808517099528",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack实战之手写一个简易的loader和plugin"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"plugin"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#plugin"}},[t._v("#")]),t._v(" plugin")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("本质上是一个Class，监听执行流程中的钩子函数，更好的控制输出，比如打包优化、资源管理、注入环境变量等；")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("webpack是通过Tapable进行事件流管理；")])])])]),t._v(" "),r("h2",{attrs:{id:"运行原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#运行原理"}},[t._v("#")]),t._v(" 运行原理")]),t._v(" "),r("ul",[r("li",[t._v("口诀：6步（"),r("strong",[t._v("读配置、生成compiler；读entries、遍历入口；loader编译、解析Ast；重复编译、重复解，依赖关系做优化；最终打包入IIFE[自执行函数]")]),t._v("）")]),t._v(" "),r("li",[r("ol",[r("li",[t._v("读取 webpack.config.js 配置文件，生成 compiler 实例，并把 compiler 实例注入 plugin 中的 apply 方法中。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("读取配置的 Entries，递归遍历所有的入口文件。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"3"}},[r("li",[t._v("对入口文件进行编译，开始 compilation 过程，使用 loader 对文件内容编译，再将编译好的文件内容解析成 AST 静态语法树。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"4"}},[r("li",[t._v("递归依赖的模块，重复第 3 步，生成 AST 语法树，在 AST 语法树中可以分析到模块之间的依赖关系，对应做出优化。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"5"}},[r("li",[t._v("将所有模块中的 require 语法替换成__webpack_require__来模拟模块化操作。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"6"}},[r("li",[t._v("最后把所有的模块打包进一个自执行函数（IIFE）中")])])])]),t._v(" "),r("h2",{attrs:{id:"实践-调优"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#实践-调优"}},[t._v("#")]),t._v(" 实践&调优")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("口诀："),r("strong",[t._v("从loader、plugin入手、以时间和空间为纬度，结合业务诉求进行优化。")]),t._v(" (思考：webpack、请求层、下载层、渲染层)")])]),t._v(" "),r("li",[r("ol",[r("li",[t._v("optimization.splitChunks：拆分代码 => 并行思维")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("Happypack：可以将loader处理成并行，更好的利用系统资源 => 并行思维")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"3"}},[r("li",[t._v("DllPlugin：可以将特定类库提前打包然后引入 => 分类思维")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"4"}},[r("li",[t._v("include、alias、thread-loader(转存到 worker pool 中)、cache-loader"),r("br"),t._v("\n核心优化思路："),r("strong",[t._v("减小检索依赖、打包的范围 => 时间纬度")]),r("br"),t._v("\n参链："),r("a",{attrs:{href:"https://yhlben.com/blog/devops-webpack.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack使用优化"),r("OutboundLink")],1),t._v(" 推荐")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"5"}},[r("li",[t._v("路由懒加载 "),r("a",{attrs:{href:"https://router.vuejs.org/zh/guide/advanced/lazy-loading.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官链"),r("OutboundLink")],1),t._v(" 把组件按组分块")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"6"}},[r("li",[t._v("mode的noParse属性，可以设置不必要的解析，比如lodash => 时间纬度")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"7"}},[r("li",[t._v("导出打包的统计文件，使用工具进行分析 webpack --profile --json > stat.json")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"8"}},[r("li",[t._v("开发环境的关闭注释：options.output.pathinfo => 空间纬度")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"9"}},[r("li",[t._v("生产环境用"),r("strong",[t._v("tree shaking")]),t._v("，只打包用到的模块，删除没用的模块 => 空间纬度")])])]),t._v(" "),r("li",[r("p",[t._v("参链："),r("a",{attrs:{href:"https://www.cnblogs.com/lvdabao/p/5944420.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack解惑：多入口文件打包策略：吕大豹"),r("OutboundLink")],1),r("br"),t._v("\n原则：")])])]),t._v(" "),r("ol",[r("li",[t._v("选择合适的打包粒度，生成的单文件大小不要超过500KB")]),t._v(" "),r("li",[t._v("充分利用浏览器的并发请求，同时保证并发数不超过6")]),t._v(" "),r("li",[t._v("尽可能让浏览器命中304，频繁改动的业务代码不要与公共代码打包")]),t._v(" "),r("li",[t._v("避免加载太多用不到的代码，层级较深的页面进行异步加载")])]),t._v(" "),r("p",[t._v("选择的打包策略如下：")]),t._v(" "),r("ol",[r("li",[t._v("第三方库如vue、jquery、bootstrap打包为一个文件")]),t._v(" "),r("li",[t._v("公共组件如弹窗、菜单等打包为一个文件")]),t._v(" "),r("li",[t._v("工具类、项目通用基类打包为一个文件")]),t._v(" "),r("li",[t._v("各个功能模块打包出自己的入口文件")]),t._v(" "),r("li",[t._v("各功能模块作用一个SPA，子页面进行异步加载：根据前端路由动态加载子页面vue-router很容易实现")])]),t._v(" "),r("ul",[r("li",[t._v("参链："),r("a",{attrs:{href:"https://juejin.cn/post/6844904183917871117",target:"_blank",rel:"noopener noreferrer"}},[t._v("在淘宝优化了一个大型项目，分享一些干货（Webpack，SplitChunk代码实例，图文结合）"),r("OutboundLink")],1),t._v(" 二刷todo")])]),t._v(" "),r("h2",{attrs:{id:"面试相关"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#面试相关"}},[t._v("#")]),t._v(" 面试相关")]),t._v(" "),r("h3",{attrs:{id:"css-loader和style-loader的区别"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#css-loader和style-loader的区别"}},[t._v("#")]),t._v(" css-loader和style-loader的区别")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("css-loader加载.css文件")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("style-loader把css-loader内部文件注入的HTML中")])])])]),t._v(" "),r("h2",{attrs:{id:"复盘总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#复盘总结"}},[t._v("#")]),t._v(" 复盘总结")]),t._v(" "),r("ul",[r("li",[r("ol",[r("li",[t._v("研发人员更像是一个"),r("strong",[t._v("设计师")]),t._v("，设计系统的架构、框架的架构，"),r("strong",[t._v("让问题可以优雅的被解决")]),t._v("，让业务有了秩序。[查看WebPack运行原理有感]")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"2"}},[r("li",[t._v("做一个有梦想的人，让家人、公司、资源围绕着自己转和集中。")])])]),t._v(" "),r("li",[r("ol",{attrs:{start:"3"}},[r("li",[t._v("像文件夹一样，"),r("strong",[t._v("向下拆解子文件夹")]),t._v("，一直到当前的困惑或问题；像文件夹一样，"),r("strong",[t._v("向上寻找父文件夹")]),t._v("，一直到当前问题的大类为止；")])])])])])}),[],!1,null,null,null);r.default=e.exports}}]);